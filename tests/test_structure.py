import pytest

from src.structure import parse_oct_input_string, parse_oct_input


@pytest.fixture()
def struct_input() -> str:
    input = """
    PeriodicDimensions = 2
    BoxShape = parallelepiped
    KPointsUseSymmetries = no
    a = 10.26120

    %LatticeParameters
    a/sqrt(2) | a/sqrt(2) | a
    %

    %LatticeVectors
    1.0 | 0.0 | 0.0
    0.0 | 1.0 | 0.0
    0.0 | 0.0 | 10.0
    %

    %Spacing
    0.45 | 0.45 | 0.35
    %

    %KPointsGrid
    2 | 2 | 1
    %
    %Coordinates
    "H"  | -7.614776392008550e+00 | 0.000000000000000e+00 | -3.108956374400000e+01
    "H"  | -3.268869762658550e+00 | 0.000000000000000e+00 | -3.108956374400000e+01
    "Si" | -5.441823077333550e+00 | 0.000000000000000e+00 | -2.933590080400000e+01
    "Si" | -5.441823077333550e+00 | 3.627882051555700e+00 | -2.684439934300000e+01
    "Si" | -1.813941025777850e+00 | 3.627882051555700e+00 | -2.430715492340000e+01
    "Si" | -1.813941025777850e+00 | 0.000000000000000e+00 | -2.177268432930000e+01
    "Si" | -5.441823077333551e+00 | 0.000000000000000e+00 | -1.923975000000000e+01
    "Si" | -5.441823077333551e+00 | 3.627882051555701e+00 | -1.667445000000000e+01
    "Si" | -1.813941025777851e+00 | 3.627882051555701e+00 | -1.410915000000000e+01
    "Si" | -1.813941025777851e+00 | 0.000000000000000e+00 | -1.154385000000000e+01
    "Si" | -5.441823077333551e+00 | 0.000000000000000e+00 | -8.978549999999998e+00
    "Si" | -5.441823077333551e+00 | 3.627882051555701e+00 | -6.413250000000000e+00
    "Si" | -1.813941025777851e+00 | 3.627882051555701e+00 | -3.847949999999999e+00
    "Si" | -1.813941025777851e+00 | 0.000000000000000e+00 | -1.282649999999999e+00
    "Si" | -5.441823077333551e+00 | 0.000000000000000e+00 | 1.282650000000001e+00
    "Si" | -5.441823077333551e+00 | 3.627882051555701e+00 | 3.847950000000001e+00
    "Si" | -1.813941025777851e+00 | 3.627882051555701e+00 | 6.413250000000001e+00
    "Si" | -1.813941025777851e+00 | 0.000000000000000e+00 | 8.978550000000002e+00
    "Si" | -5.441823077333551e+00 | 0.000000000000000e+00 | 1.154385000000000e+01
    "Si" | -5.441823077333551e+00 | 3.627882051555701e+00 | 1.410915000000000e+01
    "Si" | -1.813941025777851e+00 | 3.627882051555701e+00 | 1.667445000000000e+01
    "Si" | -1.813941025777851e+00 | 0.000000000000000e+00 | 1.923975000000000e+01
    "Si" | -5.441823077333550e+00 | 0.000000000000000e+00 | 2.177268432930000e+01
    "Si" | -5.441823077333550e+00 | 3.627882051555700e+00 | 2.430715492340000e+01
    "Si" | -1.813941025777850e+00 | 3.627882051555700e+00 | 2.684439934300000e+01
    "Si" | -1.813941025777850e+00 | 0.000000000000000e+00 | 2.933590080400000e+01
    "H"  | -3.986894340452850e+00 | 0.000000000000000e+00 | 3.108956374400000e+01
    "H"  | 3.590122888971500e-01  | 0.000000000000000e+00 | 3.108956374400000e+01
    %
    """
    return input


def test_parse_oct_input_string(struct_input):
     key_values, blocks = parse_oct_input_string(struct_input)
     eval_options = parse_oct_input(key_values, blocks)
     print(eval_options)
